{% load static %}

{% comment %}
  hero
  {% endcomment %}
  <section id="hero" class="w-full h-[450px] md:h-[850px] relative overflow-hidden">
    <!-- Preload Images -->
    <link rel="preload" as="image" href="{% static 'img/home/cars/main-car.png' %}">
    <link rel="preload" as="image" href="{% static 'img/home/cars/car-2.jpg' %}">
    <link rel="preload" as="image" href="{% static 'img/home/cars/car-3.jpg' %}">
    <link rel="preload" as="image" href="{% static 'img/home/cars/car-4.jpg' %}">

    <!-- Background layers -->
    <div class="hero-bg current absolute inset-0 bg-cover bg-[50%_50%] md:bg-[100%_100%] transition-opacity duration-1000"
      style="background-image: url('{% static 'img/home/cars/main-car.png' %}')">
    </div>
    <div class="hero-bg next absolute inset-0 bg-cover bg-[50%_50%] md:bg-[100%_100%] opacity-0 transition-opacity duration-1000"
      style="background-image: none">
    </div>

    <!-- Gradient overlay -->
    <div class="absolute inset-0 [background:linear-gradient(180deg,rgba(4,3,11,0.74)_0%,rgb(4,3,11)_100%)]">
      <div
        class="relative h-[450px] md:h-[850px]">
        <div
          class="px-3 md:mx-auto flex w-full md:w-[1280px] items-center justify-between md:gap-[419px] relative top-10 lef-0 right-0 mx-auto">
          <div id="menu-toggle" class="cursor-pointer flex flex-col w-6 md:w-16 items-start gap-1.5 md:gap-2.5 relative">
            <div class="w-3 md:w-6 relative h-0.5 bg-white"></div>

            <div class="w-6 md:w-12 relative h-0.5 bg-white"></div>

            <div class="flex flex-col items-end justify-center relative self-stretch w-full flex-[0_0_auto]">
              <div class="w-3 md:w-6 relative h-0.5 bg-white"></div>
            </div>
          </div>

          <img class="relative h-[16px] md:w-[265.35px] md:h-[39.32px]" alt="XDG Supercars Garage"
            src="{% static 'img/home/xdg-logo.svg' %}" />

          <div class="inline-flex items-center gap-4 md:gap-8 relative flex-[0_0_auto] mr-[-0.35px]">
            <img class="relative w-4 h-4 md:w-6 md:h-6" alt="User" src="{% static 'img/home/user.svg' %}" />

            <div class="relative self-stretch w-px bg-[#ffffff3d]"></div>

            <img class="relative w-4 h-4 md:w-6 md:h-6" alt="Customer service"
              src="{% static 'img/home/customer-service.svg' %}" />
          </div>
        </div>

        <div
          class="px-3 flex flex-col w-full sm:w-[80%] md:w-[1280px] items-center relative lef-0 right-0 mx-auto top-[150px] md:top-[372px]">
          <div class="arrows flex items-center justify-between relative self-stretch w-full flex-[0_0_auto]">
            <div
              class="arrow arrow-left flex w-[40px] md:w-[120px] h-[40px] md:h-[120px] items-center justify-center relative rounded-[1000px] overflow-hidden border border-solid border-[#ffffff66] cursor-pointer hover:bg-[#ffffff1a] transition-all">
              <svg class="!relative !w-6 !h-6" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12L15.41 7.41Z" fill="#ffffff" />
              </svg>
            </div>

            <div
              class="arrow arrow-right flex w-[40px] md:w-[120px] h-[40px] md:h-[120px] items-center justify-center relative rounded-[1000px] overflow-hidden border border-solid border-[#ffffff66] cursor-pointer hover:bg-[#ffffff1a] transition-all">
              <svg class="!relative !w-6 !h-6" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.70504 6L8.29504 7.41L12.875 12L8.29504 16.59L9.70504 18L15.705 12L9.70504 6Z"
                  fill="#ffffff" />
              </svg>
            </div>
          </div>

          <div class="hero-description inline-flex flex-col items-center gap-10 relative flex-[0_0_auto] mt-[-75px] md:mt-[-196px] opacity-100 transition-opacity duration-500">
            <div class="inline-flex flex-col items-center gap-4 md:gap-10 relative flex-[0_0_auto]">
              <div class="inline-flex items-center gap-4 relative flex-[0_0_auto]">
                <div
                  class="hero-description-title relative w-fit mt-[-1.00px] font-orbitron font-bold text-white text-[1.25rem] md:text-[66px] text-center tracking-0 md:tracking-[-3.30px] leading-1 md:leading-[66px]">
                  AUTO MAINTENANCE
                  <br /> &amp; REPAIR SERVICE
                </div>
              </div>

              <div class="hero-description-wrapper inline-flex items-center gap-6 relative flex-[0_0_auto] cursor-pointer" onclick="openVideoPopup()">
                <div
                  class="hero-description-subtitle relative w-fit font-ibm-plex-sans font-bold text-white text-sm text-center tracking-[2.80px] leading-[19.6px] whitespace-nowrap">
                  TAKE A TOUR
                </div>

                <div
                  class="inline-flex items-center justify-center p-2 md:p-4 relative flex-[0_0_auto] mt-[-5.00px] mb-[-5.00px] mr-[-5.00px] bg-[#c2ae8b] rounded-[1000px] overflow-hidden border-[5px] border-solid border-[#22222280]">
                  <svg class="!relative !w-3 !h-3 md:!w-6 md:!h-6" fill="none" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="white" />
                  </svg>
                </div>
              </div>

              <!-- Video Popup -->
              <div id="videoPopup" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center z-50">
                <div class="relative w-full max-w-4xl mx-4">
                  <!-- 16:9 aspect ratio wrapper -->
                  <div class="relative pt-[56.25%]">
                    <div id="videoContainer" class="absolute inset-0">
                      <!-- Video iframe will be inserted here via JavaScript -->
                    </div>
                  </div>
                  <button onclick="closeVideoPopup()" class="absolute -top-12 right-0 bg-[#c2ae8b] hover:bg-[#a89577] transition-colors duration-300 rounded-full p-2 group">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                    <span class="absolute right-full mr-2 top-1/2 transform -translate-y-1/2 whitespace-nowrap text-white text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300">Close Video</span>
                  </button>
                </div>
              </div>

              <script>
                let autoRotateInterval;
                const videoUrl = "https://www.youtube.com/watch?v=your_video_id"; // Replace with your actual video URL

                function openVideoPopup() {
                  const popup = document.getElementById('videoPopup');
                  const videoContainer = document.getElementById('videoContainer');
                  
                  if (!videoUrl) return;
                  
                  // Pause the hero animation
                  if (autoRotateInterval) {
                    clearInterval(autoRotateInterval);
                    autoRotateInterval = null;
                  }
                  
                  let videoElement;
                  
                  if (videoUrl.includes('youtube.com') || videoUrl.includes('youtu.be')) {
                    const videoId = videoUrl.split('v=')[1] || videoUrl.split('/').pop();
                    videoElement = `<iframe class="absolute inset-0 w-full h-full" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                  } else {
                    videoElement = `<video class="absolute inset-0 w-full h-full" controls><source src="${videoUrl}" type="video/mp4">Your browser does not support the video tag.</video>`;
                  }
                  
                  videoContainer.innerHTML = videoElement;
                  popup.classList.remove('hidden');
                  popup.classList.add('flex');
                }

                function closeVideoPopup() {
                  const popup = document.getElementById('videoPopup');
                  const videoContainer = document.getElementById('videoContainer');
                  videoContainer.innerHTML = '';
                  popup.classList.add('hidden');
                  popup.classList.remove('flex');
                  
                  // Resume the hero animation
                  startAutoRotate();
                }

                // Close popup when clicking outside the video
                document.getElementById('videoPopup').addEventListener('click', function(e) {
                  if (e.target === this) {
                    closeVideoPopup();
                  }
                });
              </script>
            </div>
          </div>
        </div>

        <div
          class="car-brands mx-auto inline-flex flex-wrap items-center justify-between md:justify-between gap-2 px-[7px] py-0 absolute top-[350px] md:top-[790px] left-0 right-0 w-[90%] md:w-[75%] lg:w-[50%]">

          <div class="relative w-[32px] h-[32px] md:w-[48px] md:h-[48px]">
            <img class="absolute w-8 md:w-11 md:h-11 top-0.5 left-0.5 object-cover" alt="BMW"
              src="{% static 'img/home/mercedes-benz.png' %}" />
          </div>

          <div class="relative w-[32px] h-[32px] md:w-[48px] md:h-[48px] overflow-hidden opacity-70">
            <img class="absolute w-8 md:w-[49px] md:h-[47px] top-0.5 left-0" alt="Ford"
              src="{% static 'img/home/ford.png' %}" />
          </div>

          <div class="relative w-[40px] h-[32px] md:w-[60px] md:h-[48px]">
            <img class="absolute w-8 md:w-14 md:h-[31px] top-[9px] left-0 object-cover" alt="Audi"
              src="{% static 'img/home/audi.png' %}" />
          </div>

          <div class="relative w-[32px] h-[32px] md:w-[48px] md:h-[48px]">
            <img class="absolute w-8 md:w-14 md:h-[31px] top-[2px] md:top-[9px] left-0 object-cover" alt="Rolls Royce"
              src="{% static 'img/home/rolls-royce.png' %}" />
          </div>

          <div class="relative w-[32px] h-[32px] md:w-[48px] md:h-[48px]">
            <img class="absolute w-8 md:w-[49px] md:h-[46px] top-0.5 left-0" alt="Mazda"
              src="{% static 'img/home/mazda.png' %}" />
          </div>

          <div class="relative w-[32px] h-[32px] md:w-[48px] md:h-[48px]">
            <img class="absolute w-8 md:w-[49px] md:h-10 top-[5px] left-0 object-cover" alt="Nissan"
              src="{% static 'img/home/nissan.png' %}" />
          </div>
        </div>
      </div>
    </div>
  </section>

<style>
  @keyframes zoomIn {
    from {
      transform: scale(1.3);
    }
    to {
      transform: scale(1);
    }
  }

  .hero-bg {
    transition: opacity 1s ease-in-out, transform 1.5s ease-in-out;
  }

  .hero-bg.zooming-in {
    animation: zoomIn 1.5s ease-in-out forwards;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Hero content configuration
    const heroContent = [
      {
        background: "{% static 'img/home/cars/main-car.png' %}",
        title: "AUTO MAINTENANCE<br/>&amp; REPAIR SERVICE",
        subtitle: "TAKE A TOUR",
        videoUrl: "https://www.youtube.com/watch?v=your_video_id"
      },
      {
        background: "{% static 'img/home/cars/car-2.jpg' %}",
        title: "LUXURY CAR<br/>DETAILING SERVICE",
        subtitle: "EXPLORE MORE"
      },
      {
        background: "{% static 'img/home/cars/car-3.jpg' %}",
        title: "PREMIUM CAR<br/>CUSTOMIZATION",
        subtitle: "DISCOVER NOW"
      },
      {
        background: "{% static 'img/home/cars/car-4.jpg' %}",
        title: "LUXURY CAR<br/>CUSTOMIZATION",
        subtitle: "EXPERIENCE LUXURY"
      }
    ];

    let currentIndex = 0;
    const heroSection = document.getElementById('hero');
    const heroDescription = document.querySelector('.hero-description');
    const titleElement = heroDescription.querySelector('.hero-description-title');
    const subtitleElement = heroDescription.querySelector('.hero-description-subtitle');
    const arrowLeft = document.querySelector('.arrow-left');
    const arrowRight = document.querySelector('.arrow-right');
    const currentBg = document.querySelector('.hero-bg.current');
    const nextBg = document.querySelector('.hero-bg.next');

    // Preload images
    function preloadImages() {
      const imagePromises = heroContent.map(content => {
        return new Promise((resolve, reject) => {
          const img = new Image();
          img.onload = resolve;
          img.onerror = reject;
          img.src = content.background;
        });
      });

      return Promise.all(imagePromises);
    }

    // Initialize hero after images are preloaded
    preloadImages().then(() => {
      console.log('All hero images preloaded');
      
      function updateHero(direction) {
        // Fade out current content
        heroDescription.style.opacity = '0';
        
        setTimeout(() => {
          // Update index based on direction
          if (direction === 'next') {
            currentIndex = (currentIndex + 1) % heroContent.length;
          } else {
            currentIndex = (currentIndex - 1 + heroContent.length) % heroContent.length;
          }

          // Update content
          const content = heroContent[currentIndex];
          
          // Prepare next background
          nextBg.style.backgroundImage = `url('${content.background}')`;
          nextBg.classList.add('zooming-in');
          nextBg.style.opacity = '1';

          // Update text content
          titleElement.innerHTML = content.title;
          subtitleElement.textContent = content.subtitle;

          // After animation completes
          setTimeout(() => {
            // Reset for next transition
            currentBg.style.backgroundImage = `url('${content.background}')`;
            nextBg.style.opacity = '0';
            nextBg.classList.remove('zooming-in');
            
            // Fade in new content
            heroDescription.style.opacity = '1';
          }, 1500);
        }, 500);
      }

      // Add click event listeners to arrows
      arrowLeft.addEventListener('click', () => {
        if (autoRotateInterval) {
          clearInterval(autoRotateInterval);
        }
        updateHero('prev');
        startAutoRotate();
      });
      
      arrowRight.addEventListener('click', () => {
        if (autoRotateInterval) {
          clearInterval(autoRotateInterval);
        }
        updateHero('next');
        startAutoRotate();
      });

      // Start auto-rotate
      function startAutoRotate() {
        if (autoRotateInterval) {
          clearInterval(autoRotateInterval);
        }
        autoRotateInterval = setInterval(() => {
          updateHero('next');
        }, 5000);
      }

      // Initialize first slide
      const initialContent = heroContent[0];
      currentBg.style.backgroundImage = `url('${initialContent.background}')`;
      titleElement.innerHTML = initialContent.title;
      subtitleElement.textContent = initialContent.subtitle;
      heroDescription.style.opacity = '1';

      // Start the auto-rotation
      startAutoRotate();
    }).catch(error => {
      console.error('Error preloading images:', error);
    });
  });
</script>
